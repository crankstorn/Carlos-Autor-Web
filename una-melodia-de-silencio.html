<!DOCTYPE html>
<html lang="es">
<head>
    <!-- ===== METADATOS ESENCIALES ===== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Una Melodía de Silencio - La nueva novela de Carlos Ramírez</title>
    <meta name="description" content="Explora los misterios de 'Una Melodía de Silencio', un thriller ambientado entre Copenhague y Mallorca. Conoce la sinopsis, lee reseñas y descubre el universo del libro.">

    <!-- ===== FAVICON ===== -->
    <link rel="icon" href="https://placehold.co/32x32/1A202C/FDFBF7?text=CR&font=playfair-display" type="image/png">

    <!-- ===== LIBRERÍAS Y FUENTES EXTERNAS ===== -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- ===== DATOS ESTRUCTURADOS (SEO) ===== -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Book",
      "name": "Una Melodía de Silencio",
      "url": "https://carlosramirezhernandez.com/una-melodia-de-silencio",
      "author": {
        "@type": "Person",
        "@id": "https://carlosramirezhernandez.com/#person"
      },
      "image": "https://URL-DEL-SITIO-WEB.com/images/portada-libro.jpg",
      "isbn": "978-0-123456-78-9",
      "bookFormat": "https://schema.org/Paperback",
      "abstract": "Cuando Tom, un guitarrista callejero de Mallorca, se enamora de la enigmática Eli, su mundo se transforma en una búsqueda que lo lleva hasta Copenhague. Allí, descubrirá que la familia de Eli esconde un secreto ancestral de seres primigenios y poderes extraordinarios. Perseguidos por una misteriosa organización, Tom se verá envuelto en una batalla por la supervivencia y el amor en un mundo donde lo mítico colisiona con lo real.",
      "review": [
        {
          "@type": "Review",
          "reviewBody": "Una trama que te engancha desde la primera página. No pude soltarlo.",
          "author": { "@type": "Organization", "name": "Blog 'Lectores Voraces'" }
        },
        {
          "@type": "Review",
          "reviewBody": "El contraste entre Copenhague y Mallorca está tan bien descrito que sientes que estás allí.",
          "author": { "@type": "Person", "name": "Anna B." }
        },
        {
          "@type": "Review",
          "reviewBody": "Un final sorprendente. Carlos Ramírez es un maestro del suspense.",
          "author": { "@type": "Organization", "name": "Revista 'Misterio y Letras'" }
        }
      ]
    }
    </script>

    <!-- ===== ESTILOS PERSONALIZADOS ===== -->
    <style>
        :root {
            --color-accent: #493547;
            --color-accent-hover: #66495E;
            --color-bg: #FDFBF7;
            --color-text-primary: #1A1A1A;
            --color-text-secondary: #5c5c5c;
            --color-dark-bg: #1A202C;
            --color-dark-text-primary: #F7FAFC;
            --color-dark-text-secondary: #A0AEC0;
        }
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; color: var(--color-text-primary); background-color: var(--color-bg); }
        h1, h2, h3, h4, h5, h6, .font-serif { font-family: 'Playfair Display', serif; font-weight: 400; }
        .logo-text { font-family: 'Playfair Display', serif; font-size: 1.5rem; font-weight: 700; color: var(--color-text-primary); transition: color 0.3s ease-out; }
        .logo-link:hover .logo-text { color: var(--color-accent); }
        .cta-button:disabled { background-color: #9ca3af; cursor: not-allowed; transform: scale(1); box-shadow: none; }
        .cta-button { background-color: var(--color-accent); transition: all 0.3s ease; box-shadow: 0 4px 15px 0 rgba(47, 79, 79, 0.3); }
        .cta-button:hover:not(:disabled) { transform: scale(1.05); background-color: var(--color-accent-hover); box-shadow: 0 6px 20px 0 rgba(47, 79, 79, 0.4); }
        .button-secondary { background-color: transparent; border: 2px solid var(--color-accent); color: var(--color-accent); }
        .button-secondary:hover { background-color: var(--color-accent); color: var(--color-bg); }
        .nav-active { font-weight: 600; color: var(--color-accent); }
        .dark-section { background-color: var(--color-dark-bg); background-image: url(https://www.transparenttextures.com/patterns/dark-stone.png); }
        .dark-section h1, .dark-section h2, .dark-section h3, .dark-section p, .dark-section a, .dark-section span { color: var(--color-dark-text-primary); }
        .dark-section p, .dark-section .form-input, .dark-section nav a, .dark-section .social-icon { font-family: 'Inter', sans-serif; }
        .dark-section .form-input { background-color: #2D3748; border-color: #4A5568; }
        .dark-section .footer-link { color: var(--color-dark-text-secondary); }
        .dark-section .footer-link:hover { color: var(--color-dark-text-primary); text-decoration: underline; }
        .title-separator { display: flex; align-items: center; text-align: center; color: var(--color-text-primary); margin-top: 1.5rem; margin-bottom: 3rem; }
        .title-separator::before, .title-separator::after { content: ''; flex: 1; border-bottom: 1px solid #EBE3D8; }
        .title-separator:not(:empty)::before { margin-right: 1.5em; }
        .title-separator:not(:empty)::after { margin-left: 1.5em; }
        .fade-in-section { opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .fade-in-section.is-visible { opacity: 1; transform: translateY(0); }
        .easter-egg-note { font-size: 1.5rem; line-height: 1; cursor: pointer; color: #20c2c2; opacity: 0; text-shadow: 0 0 8px rgba(32, 194, 194, 0); transition: opacity 0.3s ease-in-out, text-shadow 0.3s ease-in-out; }
        .easter-egg-note:hover { opacity: 1; text-shadow: 0 0 10px rgba(32, 194, 194, 1), 0 0 20px rgba(32, 194, 194, 0.7); }
        #secret-modal-overlay, #other-stores-modal-overlay { transition: opacity 0.3s ease-out; }
        #secret-modal, #other-stores-modal { transition: transform 0.3s ease-out, opacity 0.3s ease-out; transform: translateY(20px) scale(0.95); }
        #secret-modal-overlay.show #secret-modal, #other-stores-modal-overlay.show #other-stores-modal { transform: translateY(0) scale(1); }
        #back-to-top-btn { position: fixed; bottom: 2rem; right: 2rem; z-index: 50; opacity: 0; visibility: hidden; transform: translateY(1rem); transition: opacity 0.3s, visibility 0.3s, transform 0.3s; }
        #back-to-top-btn.show { opacity: 1; visibility: visible; transform: translateY(0); }
    </style>
</head>
<body class="antialiased">

    <header id="header" class="bg-white/90 backdrop-blur-md shadow-sm top-0 z-40">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="./index.html" class="logo-link">
                <span class="logo-text">CARLOS RAMÍREZ</span>
            </a>
            <div class="flex items-center gap-8">
                <nav id="main-nav" class="hidden md:flex items-center space-x-8">
                    <a href="./index.html" class="text-zinc-600 hover:text-[--color-accent] transition duration-300">Inicio</a>
                    <a href="./una-melodia-de-silencio.html" class="text-zinc-600 hover:text-[--color-accent] transition duration-300">El Libro</a>
                    <a href="./autor.html" class="text-zinc-600 hover:text-[--color-accent] transition duration-300">Sobre Carlos</a>
                    <!--<a href="./noticias.html" class="text-zinc-600 hover:text-[--color-accent] transition duration-300">Noticias</a>-->
                    <a href="./contacto.html" class="text-zinc-600 hover:text-[--color-accent] transition duration-300">Contacto</a>
                </nav>
                <div class="hidden md:block">
                    <span id="easter-egg-trigger" class="easter-egg-note">𝄽</span>
                </div>
                <button id="mobile-menu-button" class="md:hidden text-zinc-800 focus:outline-none">
                    <i class="fas fa-bars w-6 h-6"></i>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-zinc-200">
             <a href="./index.html" class="block px-6 py-3 text-sm text-zinc-700 hover:bg-zinc-50">Inicio</a>
            <a href="./una-melodia-de-silencio.html" class="block px-6 py-3 text-sm text-zinc-700 hover:bg-zinc-50">El Libro</a>
            <a href="./autor.html" class="block px-6 py-3 text-sm text-zinc-700 hover:bg-zinc-50">Sobre Carlos</a>
            <!--<a href="./noticias.html" class="block px-6 py-3 text-sm text-zinc-700 hover:bg-zinc-50">Noticias</a>-->
            <a href="./contacto.html" class="block px-6 py-3 text-sm text-zinc-700 hover:bg-zinc-50">Contacto</a>
        </div>
    </header>

    <main>
        <!-- ===== SECCIÓN DEL LIBRO ===== -->
        <section class="bg-[--color-bg] pt-16 pb-8">
            <div class="container mx-auto px-6">
                <div class="flex flex-col md:flex-row items-start gap-8 md:gap-12">
                    <div class="md:w-1/3 flex-shrink-0">
                        <img src="https://images.unsplash.com/photo-1727035305444-bbdfe6be13a3?q=80&w=387&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Portada de 'Una Melodía de Silencio'" class="rounded-lg shadow-2xl w-full max-w-sm mx-auto" onerror="this.onerror=null;this.src='https://placehold.co/400x600/1A202C/FDFBF7?text=Error';">
                    </div>
                    <div class="md:w-2/3">
                        <h1 class="text-4xl lg:text-5xl">Una Melodía de Silencio</h1>
                        <p class="text-xl text-zinc-600 mt-2 font-serif italic">Su amor es música. Su secreto, guerra.</p>
                       <div class="text-[--color-text-secondary] mt-6 leading-relaxed">
                            <section>
                                <p>Para Tom, la música es un don y una maldición. Un virtuoso de la guitarra capaz de silenciar un pub entero con una sola nota, pero cuya soberbia y orgullo le condenan a malvivir en las calles de Mallorca, saboteando cada oportunidad que se le presenta. Algunos dirían que está desperdiciando su vida, atrapado en la monótona rutina de cafés baratos y futuros inciertos. Pero esa rutina se rompe en mil pedazos la noche que conoce a Eli.</p>
                            </section>
                            <section class="mt-4">
                                <p>Ella no es solo una bajista enigmática; su música desafía las leyes de la física y su mirada esconde secretos de siglos. Eli ofrece a Tom algo que nunca creyó merecer: un dúo perfecto, una sintonía que va más allá de lo musical. Pero esa conexión tiene un precio.</p>
                            </section>
                            <section class="mt-4">
                                <p>Arrastrado a una guerra que se libra en los rincones oscuros de Europa, desde Palma hasta Copenhague, Tom se convierte en una pieza inesperada dentro de un juego mortal cuyas normas desconoce. Con la ayuda de Eli, deberá enfrentarse a un mundo tejido en sombras, y a los monstruos que habitan en él, si pretende proteger a Isa y Richi, su única familia. O morir en el intento.</p>
                            </section>
                        </div>
                        <div class="mt-8 flex justify-center md:justify-start">
                            <a href="./pagina-de-suscripción.html" class="cta-button text-white font-bold py-3 px-8 rounded-lg text-lg transition-transform duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-special-accent">
                                Avísame del lanzamiento
                            </a>
                        </div>
                        <!--
                        <div class="mt-8">
                            <h3 class="text-2xl mb-4">Consíguelo ahora</h3>
                            <div class="flex flex-wrap gap-4">
                                <a href="#" class="cta-button text-white font-bold py-3 px-6 rounded-lg">Comprar en Amazon</a>
                                <button id="open-stores-modal-btn" class="button-secondary font-bold py-3 px-6 rounded-lg transition-all duration-300">Otras tiendas</button>
                            </div>
                        </div>
                        -->
                    </div>
                </div>
            </div>
        </section>

        <!-- ===== SECCIÓN DE RESEÑAS ===== -->
        <!--
        <section class="pt-8 pb-8">
            <div class="container mx-auto px-6 text-center">
                <h2 class="title-separator text-4xl">Lo que dicen los lectores</h2>
                <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                    <div class="bg-white/50 p-6 rounded-lg shadow-lg border border-stone-200">
                        <p class="italic text-zinc-700">"Review 1."</p>
                        <p class="font-bold mt-4 font-serif text-[--color-text-primary]">- Blog 'Lectores Voraces'</p>
                    </div>
                    <div class="bg-white/50 p-6 rounded-lg shadow-lg border border-stone-200">
                        <p class="italic text-zinc-700">"Review 2."</p>
                        <p class="font-bold mt-4 font-serif text-[--color-text-primary]">- Anna B., Goodreads</p>
                    </div>
                    <div class="bg-white/50 p-6 rounded-lg shadow-lg border border-stone-200">
                        <p class="italic text-zinc-700">"Review 3."</p>
                        <p class="font-bold mt-4 font-serif text-[--color-text-primary]">- Revista 'Misterio y Letras'</p>
                    </div>
                </div>
            </div>
        </section>
        -->
        <!-- ===== SECCIÓN DE SPOTIFY ===== -->
        <section class="pt-8 pb-16">
            <div class="container mx-auto px-6 text-center">
                <h2 class="title-separator text-4xl">La Banda Sonora</h2>
                <div class="max-w-3xl mx-auto shadow-lg rounded-lg overflow-hidden">
                    <iframe style="border-radius:12px" src="https://open.spotify.com/embed/playlist/5ZTNoqczlRLRplcp3fXShT?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                </div>
            </div>
        </section>
    </main>

    <!-- =================================================================== -->
    <!-- ===== FOOTER (OSCURO) CON NEWSLETTER Y MEJORAS RGPD           ===== -->
    <!-- =================================================================== -->
    <footer class="dark-section py-12 mt-16">
        <div class="container mx-auto px-6">
            <div class="max-w-2xl mx-auto text-center mb-10">
                 <h3 class="text-2xl">Únete a la Comunidad</h3>
                 <p class="mt-2 text-[--color-dark-text-secondary]">Recibe noticias, contenido inédito y fechas de eventos directamente en tu correo.</p>
                <form id="newsletter-form" class="mt-6">
                    <div class="flex flex-col sm:flex-row gap-3 justify-center">
                        <input type="email" id="newsletter-email" name="email" placeholder="Tu correo electrónico" required class="w-full sm:w-auto flex-grow px-4 py-2.5 text-white form-input rounded-md focus:ring-2 focus:ring-white/80 focus:border-white/80 transition duration-300">
                        <button type="submit" id="newsletter-submit-btn" class="cta-button text-white font-bold py-2.5 px-8 rounded-md text-base">Suscribirme</button>
                    </div>
                    <div class="mt-4 text-left max-w-sm mx-auto">
                        <label for="gdpr-consent" class="flex items-start space-x-3 cursor-pointer">
                            <input type="checkbox" id="gdpr-consent" name="gdpr-consent" required class="mt-1 h-4 w-4 rounded border-gray-300 text-[--color-accent] focus:ring-[--color-accent]">
                            <span class="text-xs text-left text-[--color-dark-text-secondary]">
                                Acepto recibir comunicaciones y confirmo que he leído y acepto la <a href="./politica-de-privacidad.html" class="underline hover:text-white">Política de Privacidad</a>.
                            </span>
                        </label>
                    </div>
                </form>
                <div id="newsletter-feedback" class="mt-4 text-sm h-5"></div>
            </div>
            <nav class="mb-8 flex justify-center flex-wrap gap-x-6 gap-y-2 text-sm">
                <a href="./index.html" class="footer-link">Inicio</a>
                <a href="./una-melodia-de-silencio.html" class="footer-link">El Libro</a>
                <a href="./autor.html" class="footer-link">Sobre Carlos</a>
                <!--<a href="./noticias.html" class="footer-link">Noticias</a>-->
                <a href="./contacto.html" class="footer-link">Contacto</a>
                <a href="./politica-de-privacidad.html" class="footer-link">Política de Privacidad</a>
            </nav>
            <div class="text-center">
                <div class="flex justify-center space-x-6 mb-6">
                    <a href="#" class="social-icon footer-link text-2xl" aria-label="Enlace a Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-icon footer-link text-2xl" aria-label="Enlace a Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-icon footer-link text-2xl" aria-label="Enlace a Goodreads"><i class="fab fa-goodreads"></i></a>
                </div>
                <div class="text-sm footer-link">
                    <a href="./assets/press_kit/kit_de_prensa.zip" download class="footer-link">Kit de Prensa</a>
                    <span class="mx-2">|</span>
                    <p class="inline">&copy; <span id="year"></span> Carlos Ramírez Hernández. Todos los derechos reservados.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- =================================================================== -->
    <!-- ===== ELEMENTOS FLOTANTES Y MODALES (CON SÍMBOLO SECRETO)     ===== -->
    <!-- =================================================================== -->
    <a href="#" id="back-to-top-btn" class="p-3 rounded-full bg-[--color-accent] text-white shadow-lg hover:bg-[--color-accent-hover]">
        <i class="fas fa-arrow-up"></i>
    </a>
    <div id="other-stores-modal-overlay" class="fixed inset-0 bg-black bg-opacity-70 z-[100] flex items-center justify-center p-4 hidden opacity-0">
        <div id="other-stores-modal" class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md relative">
            <button id="close-stores-modal-btn" class="absolute top-4 right-4 text-zinc-500 hover:text-zinc-800 text-2xl">&times;</button>
            <h3 class="text-2xl mb-6 text-center">Otras Tiendas Online</h3>
            <div class="space-y-4">
                <a href="#" class="block w-full text-center bg-gray-100 hover:bg-gray-200 py-3 px-4 rounded-lg font-semibold transition">Casa del Libro</a>
                <a href="#" class="block w-full text-center bg-gray-100 hover:bg-gray-200 py-3 px-4 rounded-lg font-semibold transition">Fnac</a>
                <a href="#" class="block w-full text-center bg-gray-100 hover:bg-gray-200 py-3 px-4 rounded-lg font-semibold transition">El Corte Inglés</a>
            </div>
        </div>
    </div>
    <div id="secret-modal-overlay" class="fixed inset-0 bg-black bg-opacity-70 z-[100] flex items-center justify-center p-4 hidden opacity-0">
        <div id="secret-modal" class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md relative text-center">
            <button id="close-secret-modal-btn" class="absolute top-2 right-4 text-zinc-500 hover:text-zinc-800 text-3xl">&times;</button>
            <p class="text-xl italic text-zinc-700 leading-relaxed font-serif">
                Has encontrado un momento de silencio. A veces, es la curiosidad la que nos regala las sonrisas más inesperadas. Gracias por tu curiosidad.
            </p>
            <p class="text-right mt-4 font-semibold text-zinc-800">- Carlos Ramírez Hernández</p>
        </div>
    </div>


    <!-- =================================================================== -->
    <!-- ===== SCRIPT PRINCIPAL (VERSIÓN SEGURA Y COMPLETA)            ===== -->
    <!-- =================================================================== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- MANEJO DE LA NEWSLETTER CON NETLIFY Y RGPD ---
            const newsletterForm = document.getElementById('newsletter-form');
            if (newsletterForm) {
                const submitButton = document.getElementById('newsletter-submit-btn');
                const consentCheckbox = document.getElementById('gdpr-consent');
                submitButton.disabled = true;
                consentCheckbox.addEventListener('change', () => {
                    submitButton.disabled = !consentCheckbox.checked;
                });
                newsletterForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    if (!consentCheckbox.checked) return;
                    const form = e.target;
                    const emailInput = document.getElementById('newsletter-email');
                    const feedbackDiv = document.getElementById('newsletter-feedback');
                    const email = emailInput.value;
                    const MAILERLITE_GROUP_ID = '158756233196602950';
                    const FUNCTION_URL = '/.netlify/functions/subscribe';
                    feedbackDiv.textContent = 'Procesando...';
                    feedbackDiv.className = 'mt-4 text-sm h-5 text-gray-400';
                    submitButton.disabled = true;
                    try {
                        const response = await fetch(FUNCTION_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                email: email,
                                groupId: MAILERLITE_GROUP_ID
                            }),
                        });
                        if (response.ok) {
                            feedbackDiv.textContent = '¡Gracias por suscribirte!';
                            feedbackDiv.className = 'mt-4 text-sm h-5 text-green-400';
                            form.reset();
                            consentCheckbox.checked = false;
                            submitButton.disabled = true;
                        } else {
                            const errorData = await response.json();
                            const errorMessage = errorData.message || 'El email es inválido o ya está suscrito.';
                            feedbackDiv.textContent = errorMessage;
                            feedbackDiv.className = 'mt-4 text-sm h-5 text-red-400';
                            submitButton.disabled = false;
                        }
                    } catch (error) {
                        feedbackDiv.textContent = 'Ocurrió un error. Inténtalo de nuevo.';
                        feedbackDiv.className = 'mt-4 text-sm h-5 text-red-400';
                        console.error('Error en la suscripción:', error);
                        submitButton.disabled = false;
                    }
                });
            }

            // --- CÓDIGO GENÉRICO (MENÚ, AÑO, EASTER EGG, MODALES, ETC.) ---
            const initModal = (triggerBtnId, overlayId, closeBtnId, modalId) => {
                const triggerBtn = document.getElementById(triggerBtnId);
                const overlay = document.getElementById(overlayId);
                const closeBtn = document.getElementById(closeBtnId);
                const modal = document.getElementById(modalId);

                if (triggerBtn && overlay && closeBtn && modal) {
                    const openModal = () => {
                        overlay.classList.remove('hidden');
                        setTimeout(() => {
                            overlay.classList.add('opacity-100');
                            modal.classList.add('show');
                        }, 10);
                    };

                    const closeModal = () => {
                        overlay.classList.remove('opacity-100');
                        modal.classList.remove('show');
                        setTimeout(() => overlay.classList.add('hidden'), 300);
                    };

                    triggerBtn.addEventListener('click', openModal);
                    closeBtn.addEventListener('click', closeModal);
                    overlay.addEventListener('click', (e) => {
                        if (e.target === overlay) closeModal();
                    });
                    document.addEventListener('keydown', (e) => {
                        if (e.key === "Escape" && !overlay.classList.contains('hidden')) {
                            closeModal();
                        }
                    });
                }
            };

            initModal('easter-egg-trigger', 'secret-modal-overlay', 'close-secret-modal-btn', 'secret-modal');
            initModal('open-stores-modal-btn', 'other-stores-modal-overlay', 'close-stores-modal-btn', 'other-stores-modal');

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => { mobileMenu.classList.toggle('hidden'); });
            }

            const yearSpan = document.getElementById('year');
            if(yearSpan) { yearSpan.textContent = new Date().getFullYear(); }

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) { entry.target.classList.add('is-visible'); }
                });
            }, { rootMargin: '0px 0px -100px 0px' });
            const sections = document.querySelectorAll('.fade-in-section');
            sections.forEach(section => { observer.observe(section); });

            const backToTopBtn = document.getElementById('back-to-top-btn');
            if (backToTopBtn) {
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 300) { backToTopBtn.classList.add('show'); }
                    else { backToTopBtn.classList.remove('show'); }
                });
                backToTopBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            const navLinks = document.querySelectorAll('#main-nav a, #mobile-menu a');
            const currentPathname = window.location.pathname;

            navLinks.forEach(link => {
                const linkPathname = link.pathname;
                link.classList.remove('nav-active');
                link.removeAttribute('aria-current');
                const cleanCurrentPath = currentPathname.replace(/\/$/, "");
                const cleanLinkPath = linkPathname.replace(/\/$/, "");

                if (cleanLinkPath === cleanCurrentPath) {
                    link.classList.add('nav-active');
                    link.setAttribute('aria-current', 'page');
                }
                if (cleanCurrentPath === '' && cleanLinkPath.endsWith('/index.html')) {
                    link.classList.add('nav-active');
                    link.setAttribute('aria-current', 'page');
                }
            });
        });
    </script>
</body>
</html>

